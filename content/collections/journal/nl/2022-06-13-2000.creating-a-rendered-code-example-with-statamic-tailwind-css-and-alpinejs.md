---
id: e228df29-2493-4e57-8782-aa2373f3c69a
blueprint: journal
title: 'Creating a rendered code example with Statamic, Tailwind CSS and AlpineJS'
description: 'For recent journal entries about SVG clipping masks and animating clipping masks I wanted to render actual code examples in the article to show the reader what the end result of the tutorial would like. Since I use the Tailwind CSS JIT compiler my website ships with a CSS file that contains only the classes that are actually being used in my template files. That seems very restricting as I would probably always use some unavailable class in my examples. So I came up with a solution that utilizes the Tailwind Play CDN to live parse the code snippet and return the CSS needed.'
seo_noindex: false
seo_nofollow: false
seo_canonical_type: entry
sitemap_change_frequency: weekly
sitemap_priority: 0.5
language: en
image: journal/rendered-code-example-tailwind-css/rendered-code-example.png
author: b40458fa-e73a-4f88-bfa1-570cd54b72e0
tags:
  - statamic
  - peak
  - tailwind-css
  - alpine-js
updated_by: b40458fa-e73a-4f88-bfa1-570cd54b72e0
updated_at: 1655155735
page_builder:
  -
    article:
      -
        type: paragraph
        content:
          -
            type: text
            text: 'For recent journal entries about '
          -
            type: text
            marks:
              -
                type: link
                attrs:
                  href: 'statamic://entry::b8680119-6b41-4504-b9ce-1e986be7cccd'
                  rel: noopener
                  target: null
                  title: null
            text: 'SVG clipping masks'
          -
            type: text
            text: ' and '
          -
            type: text
            marks:
              -
                type: link
                attrs:
                  href: 'statamic://entry::eb75cb65-9995-4d7c-bc6b-2a62990b0c28'
                  rel: noopener
                  target: null
                  title: null
            text: 'animating clipping masks'
          -
            type: text
            text: ' I wanted to render actual code examples in the article to show the reader what the end result of the tutorial would like. Since I use the Tailwind CSS JIT compiler my website ships with a CSS file that contains '
          -
            type: text
            marks:
              -
                type: italic
            text: only
          -
            type: text
            text: " the classes that are actually being used in my template files. That seems very restricting as I would probably always use some unavailable class in my examples. So I came up with a solution that utilizes the Tailwind Play CDN to live parse the code snippet and return the CSS needed. This is an example of what we're building."
      -
        type: set
        attrs:
          values:
            type: html
            size: md
            tailwind: true
            html: |-
              <div class="tw-p-12 tw-flex tw-justify-center tw-items-center">
                <span class="tw-text-2xl tw-font-bold tw-text-center tw-text-[#FA6400]">This orange color isn't used anywhere on this website but the classes needed are generated in real-time.</span>
              </div>
            caption: "An example of the component we're making."
      -
        type: paragraph
        content:
          -
            type: text
            text: "Since the Tailwind CDN comes from a non EU server, personal information (IP-address and maybe more) will transfer outside of the EU. To respect the GDPR we need the users permission for this. On this website I've put this information in my "
          -
            type: text
            marks:
              -
                type: link
                attrs:
                  href: 'statamic://asset::assets::legal/privacy-statement-en.pdf'
                  rel: noopener
                  target: null
                  title: null
            text: 'privacy statement'
          -
            type: text
            text: " and decided to ask for permission on a per-session basis. Let's get started."
      -
        type: heading
        attrs:
          level: 2
        content:
          -
            type: text
            text: 'The Bard set'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'Peak uses Bard as the editor for long form content like this very article. Within I have various sets like a figure, a code block and a table. To quickly scaffold a new set in Peak, simply run '
          -
            type: text
            marks:
              -
                type: code
            text: 'php please peak:add-set'
          -
            type: text
            text: ' in your terminal and type in a '
          -
            type: text
            marks:
              -
                type: code
            text: set_name
          -
            type: text
            text: '. This does three things:'
      -
        type: ordered_list
        attrs:
          order: 1
        content:
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'It generates '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: resources/fieldsets/set_name.yaml
                  -
                    type: text
                    text: ' where we can define our fields for this set. By default it also contains a sizing utility so in the Control Panel we can size the block normal, LG or XL. '
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'It generates '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: resources/views/components/_set_name.antlers.html
                  -
                    type: text
                    text: ' as a template for this set. The set will respect the sizing set in the control panel.'
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'It updates '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: resources/fieldsets/article.yaml
                  -
                    type: text
                    text: ' to include the generated set.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'After running this command the Article Page Builder Block will contain the set. I named it '
          -
            type: text
            marks:
              -
                type: code
            text: HTML
          -
            type: text
            text: .
      -
        type: set
        attrs:
          values:
            type: figure
            size: md
            style: color
            caption: 'The article block includes our new set called HTML.'
            browser_frame: true
            image: journal/rendered-code-example-tailwind-css/a-set-in-bard.png
      -
        type: paragraph
        content:
          -
            type: text
            text: 'By default the generated fieldset looks like this.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |-
                title: HTML
                fields:
                  -
                    handle: size
                    field: common.size
                    config:
                      instructions: 'The size in which the HTML should be displayed.'
              mode: yaml-frontmatter
            caption: 'The generated fieldset YAML file.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'We need to add some fields to be able to input any code that we want rendered on the frontend. I choose the following fields:'
      -
        type: ordered_list
        attrs:
          order: 1
        content:
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'A '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: toggle
                  -
                    type: text
                    text: ' to optonally enable the Tailwind CDN functionality.'
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'A '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: code
                  -
                    type: text
                    text: ' field set to HTML.'
          -
            type: list_item
            content:
              -
                type: paragraph
                content:
                  -
                    type: text
                    text: 'A '
                  -
                    type: text
                    marks:
                      -
                        type: code
                    text: text
                  -
                    type: text
                    text: ' field to render a caption below it.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'My fieldset now looks like this.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |-
                title: HTML
                fields:
                  -
                    handle: size
                    field: common.size
                    config:
                      instructions: 'The size in which the HTML should be displayed.'
                  -
                    handle: tailwind
                    field:
                      default: false
                      display: 'Load Tailwind CSS'
                      type: toggle
                      icon: toggle
                      listable: hidden
                      instructions_position: below
                      read_only: false
                      instructions: 'Uses the Play CDN and JIT. Utilities will scoped under `tw-utility`.'
                  -
                    handle: html
                    field:
                      theme: material
                      mode: htmlmixed
                      mode_selectable: false
                      indent_type: spaces
                      indent_size: 2
                      key_map: default
                      line_numbers: true
                      line_wrapping: true
                      display: Code
                      type: code
                      icon: code
                      localizable: true
                      listable: hidden
                      instructions_position: below
                      read_only: false
                      validate:
                        - required
                  -
                    handle: caption
                    field:
                      input_type: text
                      type: text
                      localizable: true
                      listable: hidden
                      display: Caption
              mode: yaml-frontmatter
            caption: 'The complete HTML fieldset YAML.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'That fieldset will end up looking like this.'
      -
        type: set
        attrs:
          values:
            type: figure
            image: journal/rendered-code-example-tailwind-css/the-final-html-set-in-bard.png
            size: md
            style: color
            caption: 'This is how the fieldset looks in the Statamic Control Panel.'
            browser_frame: true
      -
        type: heading
        attrs:
          level: 2
        content:
          -
            type: text
            text: 'The template logic'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'To wire this all up we need to edit the generated template file. The following example is what Peak generates by default. It includes IDE hinting for the '
          -
            type: text
            marks:
              -
                type: link
                attrs:
                  href: 'https://antlers.dev'
                  rel: noopener
                  target: _blank
                  title: null
            text: 'VS Code Antlers Toolbox'
          -
            type: text
            text: ', HTML comments to make it easier to debug your templates and the '
          -
            type: text
            marks:
              -
                type: link
                attrs:
                  href: 'https://peak.1902.studio/features/bard.html#adding-sets'
                  rel: noopener
                  target: _blank
                  title: null
            text: 'Peak sizing utilities'
          -
            type: text
            text: ' that give the editor a choice how big the component should be rendered.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |
                {{#
                	@name HTML
                	@desc The HTML component.
                  @set page.article.html
                #}}

                <!-- /components/_html.antlers.html -->
                <div
                    class="
                        not-prose
                        {{ switch(
                            (size == 'md') => 'size-md',
                            (size == 'lg') => 'size-lg',
                            (size == 'xl') => 'size-xl',
                            () => 'size-md'
                        )}}
                    "
                >
                    <h2>🔧<br>HTML</h2>
                </div>
                <!-- End: /components/_html.antlers.html -->
              mode: handlebars
            caption: 'The bare bones HTML component template file.'
      -
        type: paragraph
        content:
          -
            type: text
            text: "The first thing we need to add is a bit Alpine logic. Since the user should give permission for using the Tailwind CDN I create a persisted store containing the permission. I'm using an Alpine store called "
          -
            type: text
            marks:
              -
                type: code
            text: twCDNConsent
          -
            type: text
            text: ' so a user '
          -
            type: text
            marks:
              -
                type: italic
            text: 'only '
          -
            type: text
            text: 'has to give permission once should a page contain multiple components.  This is how it looks.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |-
                {{ if tailwind }}
                    {{ once }}
                        <script>
                            document.addEventListener('alpine:init', () => {
                                Alpine.store('twCDNConsent', {
                                    value: Alpine.$persist(false).as('twCDNConsent').using(sessionStorage),
                                    set(value) {
                                        this.value = value
                                    }
                                })
                            })
                        </script>
                    {{ /once }}
                {{ /if }}
              mode: handlebars
            caption: 'The final template to render a code example.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'Using a store makes all components reactive. This means a user only has to accept once per session and then all components will render. I use Alpine Persist to store this consent in the browsers '
          -
            type: text
            marks:
              -
                type: code
            text: sessionStorage
          -
            type: text
            text: '. This storage value is also called '
          -
            type: text
            marks:
              -
                type: code
            text: twCDNConsent
          -
            type: text
            text: '. The store gets a '
          -
            type: text
            marks:
              -
                type: code
            text: set()
          -
            type: text
            text: ' method to update the store value. '
      -
        type: paragraph
        content:
          -
            type: text
            text: 'This store logic is wrapped in two Antlers tags. The logic should '
          -
            type: text
            marks:
              -
                type: italic
            text: only
          -
            type: text
            text: ' be output when the '
          -
            type: text
            marks:
              -
                type: code
            text: tailwind
          -
            type: text
            text: ' toggle in the fieldset is set to '
          -
            type: text
            marks:
              -
                type: code
            text: 'true'
          -
            type: text
            text: ', and it only has to be defined '
          -
            type: text
            marks:
              -
                type: code
            text: once
          -
            type: text
            text: ' should your page contain multiple of those HTML components.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'Next up we need to init the actual Alpine component.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |-
                {{ if tailwind }}
                    x-data="{
                        html: '' ,
                        loadTailwind() {
                            {{ once }}
                                let tailwind = document.createElement('script')
                                tailwind.src = 'https://cdn.tailwindcss.com'
                                $root.appendChild(tailwind)
                                let config = document.createElement('script')
                                config.textContent = 'tailwind.config={prefix:\'tw-\',corePlugins:{preflight:false}}'
                                tailwind.onload = () => { $root.appendChild(config) }
                            {{ /once }}
                        }
                    }"
                    x-effect="$store.twCDNConsent.value && (html = '{{ html | add_slashes | entities | sanitize | collapse_whitespace }}') && loadTailwind()"
                {{ else }}
                    x-data="{
                        html: '{{ html | entities | add_slashes | sanitize | collapse_whitespace }}'
                    }"
                {{ /if }}
              mode: handlebars
            caption: 'Initializing the Alpine component.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'So what happens here is the following.'
      -
        type: paragraph
        content:
          -
            type: text
            text: 'And this is the final component.'
      -
        type: set
        attrs:
          values:
            type: code
            size: md
            code:
              code: |-
                {{#
                	@name HTML
                	@desc The HTML component.
                  @set page.article.html
                #}}

                <!-- /components/_html.antlers.html -->
                <div
                    class="
                        not-prose
                        my-4
                        {{ switch(
                            (size == 'md') => 'size-md',
                            (size == 'lg') => 'size-lg',
                            (size == 'xl') => 'size-xl',
                            () => 'size-md'
                        )}}
                    "
                >
                    {{ partial:components/title_bar }}
                    {{ if tailwind }}
                        {{ once }}
                            <script>
                                document.addEventListener('alpine:init', () => {
                                    Alpine.store('twCDNConsent', {
                                        value: Alpine.$persist(false).as('twCDNConsent').using(sessionStorage),
                                        set(value) {
                                            this.value = value
                                        }
                                    })
                                })
                            </script>
                        {{ /once }}
                    {{ /if }}

                    <div
                        {{ if tailwind }}
                            x-data="{
                                html: '' ,
                                loadTailwind() {
                                    {{ once }}
                                        let tailwind = document.createElement('script')
                                        tailwind.src = 'https://cdn.tailwindcss.com'
                                        $root.appendChild(tailwind)
                                        let config = document.createElement('script')
                                        config.textContent = 'tailwind.config={prefix:\'tw-\',corePlugins:{preflight:false}}'
                                        tailwind.onload = () => { $root.appendChild(config) }
                                    {{ /once }}
                                }
                            }"
                            x-effect="$store.twCDNConsent.value && (html = '{{ html | add_slashes | entities | sanitize | collapse_whitespace }}') && loadTailwind()"
                        {{ else }}
                            x-data="{
                                html: '{{ html | entities | add_slashes | sanitize | collapse_whitespace }}'
                            }"
                        {{ /if }}
                        class="border border-primary dark:border-secondary"
                    >
                        <div x-html="html">
                        </div>
                        {{ if tailwind }}
                            <div x-show="!$store.twCDNConsent.value" class="w-full h-44 p-6 flex flex-col justify-center items-center space-y-4 bg-black/10">
                                <button
                                    class="relative py-2 px-3 border border-primary dark:border-secondary bg-primary dark:bg-secondary text-white focus:outline-none focus-visible:ring-4 ring-primary ring-offset-2 dark:ring-offset-neutral dark:ring-secondary motion-safe:transition group"
                                    @click="$store.twCDNConsent.set(true)"
                                >
                                    <span class="uppercase tracking-wider">{{ trans:strings.run_code }}</span>
                                    <div class="absolute inset-0 py-2 px-3 bg-white dark:bg-neutral text-primary dark:text-secondary [clip-path:circle(20%_at_-20%_130%)] group-hover:[clip-path:circle(180%_at_-20%_130%)] motion-safe:transition-all" aria-hidden="true">
                                        <span class="text-primary dark:text-secondary uppercase tracking-wider">
                                            {{ trans:strings.run_code }}
                                        </span>
                                    </div>
                                </button>
                                <div>
                                    {{ partial:typography/title as="{ as or 'span' }" content="{ trans:strings.run_code_explainer }" }}
                                    {{ if configuration:privacy_statement_type == 'entry' }}
                                        <a class="font-medium text-xs uppercase tracking-wider not-prose leading-snug text-primary dark:text-secondary underline" href="{{ configuration:privacy_statement_entry:url }}">{{ trans:strings.cookie_learn_more }}</a>
                                    {{ elseif configuration:privacy_statement_type == 'pdf' }}
                                        <a class="font-medium text-xs uppercase tracking-wider not-prose leading-snug text-primary dark:text-secondary underline" href="{{ configuration:privacy_statement_asset }}" target="_blank">{{ trans:strings.cookie_learn_more }}</a>
                                    {{ /if }}
                                </div>
                            </div>
                        {{ /if }}
                    </div>
                    {{ partial:typography/caption as="figcaption" }}
                </div>
                <!-- End: /components/_html.antlers.html -->
              mode: handlebars
            caption: 'The final template to render a code example.'
      -
        type: paragraph
    background_text_position: start
    type: article
    enabled: true
---
